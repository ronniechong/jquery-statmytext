!function(a){a.fn.statMyText=function(b){var c=[["alpha","freq"],["asc","desc"]],d={chars:{value:0,textHolder:"Characters"},words:{value:0,textHolder:"Words"},whitespaces:{value:0,textHolder:"Whitespaces"}},e={regexHTML:/(<([^>]+)>)/gi,regexExtraWhiteSpace:/[\s\n\r]+/g,regexAlphaNum:/[^a-z0-9]/gi,regexAlpha:/[^a-z]/gi,regexWhiteSpace:/\s/g},f={},g=a.extend({displayInfo:!0,displayController:!0,excludeHTML:!0,excludeNum:!1,caseSensitive:!1,sortBy:c[0][0],sortOrder:c[1][0],statsOutputClass:"result-stats",chartOutputClass:"result-output",controllerOutputClass:"stats-controller",listSortByClass:"sortBy",listSortOrderClass:"sortOrder",sortOrderText:["Ascending","Descending"],sortByText:["Alphabetical","Frequency"],onSortComplete:function(){}},b),h={onSortCompleteCallback:{sortBy:g.sortBy,sortOrder:g.sortOrder}};return this.each(function(){"use strict";var b=a(this),i=function(b,c){var h,i=b,j=new Array;i=a.trim(i),g.excludeHTML&&(i=b.replace(e.regexHTML,"")),d.whitespaces.value=null==i.match(e.regexWhiteSpace)?0:i.match(e.regexWhiteSpace).length,d.chars.value=i.length,j=a.trim(i).replace(e.regexExtraWhiteSpace," ").split(" "),d.words.value=1==j.length?j[0].length>=1?1:0:j.length,h={},i=a.trim(i).replace(g.excludeNum?e.regexAlpha:e.regexAlphaNum,"");for(var k=0;k<i.length;k++){var m=i[k];g.caseSensitive||(m=m.toLowerCase()),h[m]=m in h?h[m]+1:1}f=h,l(f,c),g.displayInfo&&o(c)},j=function(c,d,e){var f=c.find("li").get();return f.sort(function(b,c){var f="alpha"==d?a(b).attr("data-char"):parseInt(a(b).attr("data-value")),g="alpha"==d?a(c).attr("data-char"):parseInt(a(c).attr("data-value")),h="desc"==e?1:-1,i="desc"==e?-1:1;return g>f?h:f>g?i:0}),c.empty(),a.each(f,function(a,b){c.append(b)}),a.isFunction(g.onSortComplete)&&g.onSortComplete.call(b,h.onSortCompleteCallback),c},k=function(b){var c=b.find("[class="+g.chartOutputClass+"]"),d=c.find(".chart").length<=0?1:c.find(".chart").length+1,e=a("<div/>").addClass("chart").attr("id","chart"+d).append(a("<ul/>").addClass("list-chart")).append(a("<span/>").addClass("range min-val").attr("data-value",0).text("0")).append(a("<span/>").addClass("range med-val").attr("data-value",0).text("0")).append(a("<span/>").addClass("range max-val").attr("data-value",0).text("0"));c.append(e).hide()},l=function(b,c){var d,e,h=c.find(".chart").last(),i=h.find(".list-chart"),k=0,l=m(f,"max")<=10?10:10*Math.ceil(m(f,"max")/10),e=m(f,"max")<=10?5:Math.ceil(l/2),n=c.find("[class="+g.chartOutputClass+"]");n.is(":hidden")&&n.fadeIn(300),h.find(".min-val").text(k).attr("data-value",k),h.find(".med-val").text(e).attr("data-value",e),h.find(".max-val").text(l).attr("data-value",l),i.empty();for(d in b){var o=b[d]/l*100,p=a("<li/>").attr("data-char",d).attr("data-value",b[d]).append(a("<div/>").addClass("bar-container").append(a("<div/>").addClass("bar").css("width",o+"%").append(a("<span/>").addClass("value").html(b[d])).append(a("<span/>").addClass("char").html(d))));i.append(p)}i=j(i,g.sortBy,g.sortOrder)},m=function(a,b){var c=Object.keys(a).map(function(b){return a[b]});return c.length<=0?0:"min"==b?Math.min.apply(null,c):"max"==b?Math.max.apply(null,c):void 0},n=function(b){for(var d,e,f=[g.sortByText,g.sortOrderText],i=[g.listSortByClass,g.listSortOrderClass],k=b.find(".chart").last(),l=k.find(".list-chart"),m=0;m<i.length;m++)if(d=a("<ul/>").addClass(i[m]),b.find('[class="'+i[m]+'"]').length<=0){for(var n=0;n<f.length;n++)e=f[m][n],d.append(a("<li>").append(a("<a/>").attr({href:"#","data-sort":c[m][n]}).html(e)));b.find('[class="'+g.controllerOutputClass+'"]').append(d),b.find('[data-sort="'+g.sortBy+'"]').addClass("active"),b.find('[data-sort="'+g.sortOrder+'"]').addClass("active")}b.find('[class="'+g.controllerOutputClass+'"]').on("click","a",function(c){c.preventDefault();var d=a(this).parent().closest("ul");d.find("a").removeClass("active"),a(this).addClass("active"),g.sortBy=h.onSortCompleteCallback.sortBy=b.find(a('[class="'+g.listSortByClass+'"] .active')).attr("data-sort"),g.sortOrder=h.onSortCompleteCallback.sortOrder=b.find(a('[class="'+g.listSortOrderClass+'"] .active')).attr("data-sort"),l=j(l,g.sortBy,g.sortOrder)})},o=function(b){var c,e,f=b.find('[class="'+g.statsOutputClass+'"]');if(!f.find("ul").length){e=a("<ul>").addClass("list-stats");for(c in d)e.append(a("<li>").append(a("<span>").addClass("textHolder")).append(a("<span>").addClass("value")).attr("data-type",c));f.append(e)}for(c in d)a('[data-type="'+c+'"]',f).find(".textHolder").text(d[c].textHolder),a('[data-type="'+c+'"]',f).find(".value").text(d[c].value)},p=function(b){k(b),g.displayInfo&&o(b),g.displayController&&n(b),a("#textInput",b).keyup(function(){i(a(this).val(),b)})};p(b)})}}(jQuery);