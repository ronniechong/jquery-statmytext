!function(t){t.fn.statMyText=function(a){var e=[["alpha","freq"],["asc","desc"]],r={chars:{value:0,textHolder:"Characters"},words:{value:0,textHolder:"Words"},whitespaces:{value:0,textHolder:"Whitespaces"}},s={regexHTML:/(<([^>]+)>)/gi,regexExtraWhiteSpace:/[\s\n\r]+/g,regexAlphaNum:/[^a-z0-9]/gi,regexAlpha:/[^a-z]/gi,regexWhiteSpace:/\s/g},l={},n=t.extend({displayInfo:!0,displayController:!0,excludeHTML:!0,excludeNum:!1,caseSensitive:!1,sortBy:e[0][0],sortOrder:e[1][0],statsOutputClass:"result-stats",chartOutputClass:"result-output",controllerOutputClass:"stats-controller",listSortByClass:"sortBy",listSortOrderClass:"sortOrder",sortOrderText:["Ascending","Descending"],sortByText:["Alphabetical","Frequency"],onSortComplete:function(){}},a),d={onSortCompleteCallback:{sortBy:n.sortBy,sortOrder:n.sortOrder}};return this.each(function(){"use strict";var a=t(this),i=function(a,e){var d,i=a,o=new Array;i=t.trim(i),n.excludeHTML&&(i=a.replace(s.regexHTML,"")),r.whitespaces.value=null==i.match(s.regexWhiteSpace)?0:i.match(s.regexWhiteSpace).length,r.chars.value=i.length,o=t.trim(i).replace(s.regexExtraWhiteSpace," ").split(" "),r.words.value=1==o.length?o[0].length>=1?1:0:o.length,d={},i=t.trim(i).replace(n.excludeNum?s.regexAlpha:s.regexAlphaNum,"");for(var p=0;p<i.length;p++){var u=i[p];n.caseSensitive||(u=u.toLowerCase()),d[u]=u in d?d[u]+1:1}l=d,c(l,e),n.displayInfo&&f(e)},o=function(e,r,s){var l=e.find("li").get();return l.sort(function(a,e){var l="alpha"==r?t(a).attr("data-char"):parseInt(t(a).attr("data-value")),n="alpha"==r?t(e).attr("data-char"):parseInt(t(e).attr("data-value")),d="desc"==s?1:-1,i="desc"==s?-1:1;return n>l?d:l>n?i:0}),e.empty(),t.each(l,function(t,a){e.append(a)}),t.isFunction(n.onSortComplete)&&n.onSortComplete.call(a,d.onSortCompleteCallback),e},p=function(a){var e=a.find("[class="+n.chartOutputClass+"]"),r=e.find(".chart").length<=0?1:e.find(".chart").length+1,s=t("<div/>").addClass("chart").attr("id","chart"+r).append(t("<ul/>").addClass("list-chart")).append(t("<span/>").addClass("range min-val").attr("data-value",0).text("0")).append(t("<span/>").addClass("range med-val").attr("data-value",0).text("0")).append(t("<span/>").addClass("range max-val").attr("data-value",0).text("0"));e.append(s).hide()},c=function(a,e){var r,s,d=e.find(".chart").last(),i=d.find(".list-chart"),p=0,c=u(l,"max")<=10?10:10*Math.ceil(u(l,"max")/10),s=u(l,"max")<=10?5:Math.ceil(c/2),h=e.find("[class="+n.chartOutputClass+"]");h.is(":hidden")&&h.fadeIn(300),d.find(".min-val").text(p).attr("data-value",p),d.find(".med-val").text(s).attr("data-value",s),d.find(".max-val").text(c).attr("data-value",c),i.empty();for(r in a){var f=a[r]/c*100,v=t("<li/>").attr("data-char",r).attr("data-value",a[r]).append(t("<div/>").addClass("bar-container").append(t("<div/>").addClass("bar").css("width",f+"%").append(t("<span/>").addClass("value").html(a[r])).append(t("<span/>").addClass("char").html(r))));i.append(v)}i=o(i,n.sortBy,n.sortOrder)},u=function(t,a){var e=Object.keys(t).map(function(a){return t[a]});return e.length<=0?0:"min"==a?Math.min.apply(null,e):"max"==a?Math.max.apply(null,e):void 0},h=function(a){for(var r,s,l=[n.sortByText,n.sortOrderText],i=[n.listSortByClass,n.listSortOrderClass],p=a.find(".chart").last(),c=p.find(".list-chart"),u=0;u<i.length;u++)if(r=t("<ul/>").addClass(i[u]),a.find('[class="'+i[u]+'"]').length<=0){for(var h=0;h<l.length;h++)s=l[u][h],r.append(t("<li>").append(t("<a/>").attr({href:"#","data-sort":e[u][h]}).html(s)));a.find('[class="'+n.controllerOutputClass+'"]').append(r),a.find('[data-sort="'+n.sortBy+'"]').addClass("active"),a.find('[data-sort="'+n.sortOrder+'"]').addClass("active")}a.find('[class="'+n.controllerOutputClass+'"]').on("click","a",function(e){e.preventDefault();var r=t(this).parent().closest("ul");r.find("a").removeClass("active"),t(this).addClass("active"),n.sortBy=d.onSortCompleteCallback.sortBy=a.find(t('[class="'+n.listSortByClass+'"] .active')).attr("data-sort"),n.sortOrder=d.onSortCompleteCallback.sortOrder=a.find(t('[class="'+n.listSortOrderClass+'"] .active')).attr("data-sort"),c=o(c,n.sortBy,n.sortOrder)})},f=function(a){var e,s,l=a.find('[class="'+n.statsOutputClass+'"]');if(!l.find("ul").length){s=t("<ul>").addClass("list-stats");for(e in r)s.append(t("<li>").append(t("<span>").addClass("textHolder")).append(t("<span>").addClass("value")).attr("data-type",e));l.append(s)}for(e in r)t('[data-type="'+e+'"]',l).find(".textHolder").text(r[e].textHolder),t('[data-type="'+e+'"]',l).find(".value").text(r[e].value)},v=function(a){p(a),n.displayInfo&&f(a),n.displayController&&h(a),t("#textInput",a).keyup(function(){i(t(this).val(),a)})};v(a)})}}(jQuery);